package osgi.enroute.trains.application;

import aQute.lib.io.IO;
import junit.framework.TestCase;
import osgi.enroute.trains.application.LayoutAdapter.Layout;
import osgi.enroute.trains.track.util.Tracks;

public class LayoutTest extends TestCase {

	public void testLayout() throws Exception {
		String plan = IO.collect(LayoutTest.class.getResource("simple.txt"));
		Tracks<Layout> track = new Tracks<>(plan, new LayoutAdapter());
		track.getRoot().get().layout(0, 0, null);
		
		assertEquals( "A00", track.getHandler("A00").segment.id);
		assertEquals( 0, track.getHandler("A00").get().getPosition().x);
		assertEquals( 0, track.getHandler("A00").get().getPosition().y);

		assertEquals( "X01", track.getHandler("X01").segment.id);
		assertEquals( 1, track.getHandler("X01").get().getPosition().x);
		assertEquals( 0, track.getHandler("X01").get().getPosition().y);

		assertEquals( "B00", track.getHandler("B00").segment.id);
		assertEquals( 2, track.getHandler("B00").get().getPosition().x);
		assertEquals( 0, track.getHandler("B00").get().getPosition().y);
		
		assertEquals( "C00", track.getHandler("C00").segment.id);
		assertEquals( 2, track.getHandler("C00").get().getPosition().x);
		assertEquals( 1, track.getHandler("C00").get().getPosition().y);
		
		assertEquals( "C01", track.getHandler("C01").segment.id);
		assertEquals( 3, track.getHandler("C01").get().getPosition().x);
		assertEquals( 1, track.getHandler("C01").get().getPosition().y);
		
		assertEquals( "X02", track.getHandler("X02").segment.id);
		assertEquals( 4, track.getHandler("X02").get().getPosition().x);
		assertEquals( 0, track.getHandler("X02").get().getPosition().y);
		
	}
}
